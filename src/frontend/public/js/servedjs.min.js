/*!
 * MIT License
 *
 * Copyright (c) 2017-2019 Imre Tabur <imre.tabur@eesti.ee>
 */
"use strict";!function(n){var i=n.jsdi=n.jsdi||{};i.service("$log",function(){var t={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5,ALL:6,currentLevel:0,setLevel:function(e){t.levelIsInRange(e)&&(t.currentLevel=e)},levelIsInRange:function(e){return t.OFF<=e&&e<=t.ALL},shouldLog:function(e){return t.currentLevel>=e},error:function(){console&&t.shouldLog(t.ERROR)&&console.error.apply(console,arguments)},warn:function(){console&&t.shouldLog(t.WARN)&&console.warn.apply(console,arguments)},info:function(){console&&t.shouldLog(t.INFO)&&console.info.apply(console,arguments)},log:function(){console&&t.shouldLog(t.INFO)&&console.log.apply(console,arguments)},debug:function(){console&&t.shouldLog(t.DEBUG)&&console.log.apply(console,arguments)},trace:function(){console&&t.shouldLog(t.TRACE)&&console.trace.apply(console,arguments)}};return t}),i.service("$browser",function(){var e={init:function(){},forward:function(){n&&n.history.forward()},back:function(){n&&n.history.back()},go:function(e){n&&("number"==typeof e?n.history.go(e):n.location.hash="#"+e)}};return e});function e(e){var t={storage:e,get:function(e){if(e){var t=this.storage.getItem(e);if(t)return JSON.parse(t)}return null},set:function(e,t){e&&t&&this.storage.setItem(e,JSON.stringify(t))},removeItem:function(e){e&&this.storage.removeItem(e)}};return t}!function(){var e,t,o=[{globalName:"_",serviceName:"$lodash"},{globalName:"S",serviceName:"$strings"}];for(t=0;t<o.length;t++)n[(e=o[t]).globalName]&&i.service(e.serviceName,n[e.globalName])}(),i.service("$localStorage",e(localStorage)),i.service("$sessionStorage",e(sessionStorage)),i.service("$placeholders",function(){return{replace:function(e,t){var o,n;if(e&&t)for(o in t)n=new RegExp("\\$\\{"+o+"\\}","g"),e=e.replace(n,t[o]);return e}}}),i.service("$timer",function(){return{newTimer:function(e,t){return{millis:t,timer:null,start:function(){this.timer=setTimeout(e,this.millis)},stop:function(){clearTimeout(this.timer)}}},newInterval:function(e,t){return{millis:t,timer:null,start:function(){this.timer=setInterval(e,this.millis)},stop:function(){clearTimeout(this.timer)}}}}}),i.service("$geo",function(){return{DEGREE_METERS:111134,newWatcher:function(t,e,o){return{success:function(e){t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,speed:e.coords.speed,heading:e.coords.heading,timestamp:e.timestamp})},error:e,options:o||{enableHighAccuracy:!0,maximumAge:0},watchId:null,start:function(){this.watchId=navigator.geolocation.watchPosition(this.success,this.error,this.options)},stop:function(){navigator.geolocation.clearWatch(this.watchId),this.watchId=null}}},newPath:function(e){return{points:e,init:function(){this.travelAndCalc()},travelAndCalc:function(){var e;for(this.points[0],e=1;e<this.points.length;e++)this.points[e]}}},pointInMeters:function(e){return{latitude:this.DEGREE_METERS*e.latitude,longitude:this.calcLongitudeMetersCoeficent(e.latitude)*e.longitude}},calcLongitudeMetersCoeficent:function(e){return this.DEGREE_METERS*this.calcLatitudeCoeficent(e)},calcLatitudeCoeficent:function(e){return Math.cos(this.calcDegreeRadians(e))},calcDegreeRadians:function(e){return Math.PI*e/180}}})}("undefined"==typeof window?global:window);